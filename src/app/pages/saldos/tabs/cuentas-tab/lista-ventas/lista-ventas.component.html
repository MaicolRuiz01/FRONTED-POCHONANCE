<h2>Detalle de Cuenta</h2>
<p-button label="Regresar" icon="pi pi-arrow-left" class="p-button-text p-mb-3" (click)="goBack()"></p-button>

<p-card>
  <p-tabView (onChange)="onTabChange($event)">
    <!-- TAB 1: Ventas -->
    <p-tabPanel header="Ventas">
      <p-table [value]="ventas" *ngIf="!loadingVentas && ventas.length > 0" class="p-datatable-striped p-shadow-2">
        <ng-template pTemplate="header">
          <tr>
            <th>ID</th>
            <th>Monto (USD)</th>
            <th>Monto (COP)</th>
            <th>Fecha</th>
          </tr>
        </ng-template>
        <ng-template pTemplate="body" let-venta>
          <tr>
            <td>{{ venta.id }}</td>
            <td>{{ venta.dollarsUs | number:'1.2-2' }}</td>
            <td>{{ venta.pesosCop | currency:'COP':'symbol':'1.0-0' }}</td>
            <td>{{ venta.date | date:'short' }}</td>
          </tr>
        </ng-template>
      </p-table>

      <div *ngIf="loadingVentas">Cargando ventas…</div>
      <p *ngIf="!loadingVentas && ventas.length === 0">No hay ventas registradas para esta cuenta.</p>
    </p-tabPanel>

    <!-- TAB 2: Movimientos -->
    <p-tabPanel header="Movimientos">
      <p-tabView>
        <!-- ENTRADAS -->
        <p-tabPanel header="Entradas">
          <p-table
            [value]="movimientosEntradas"
            *ngIf="!loadingMovs && movimientosEntradas.length > 0"
            class="p-datatable-striped p-shadow-2">
            <ng-template pTemplate="header">
              <tr>
                <th>Fecha</th>
                <th>Tipo</th>
                <th>Monto (COP)</th>
                <th>Detalle</th>
              </tr>
            </ng-template>
            <ng-template pTemplate="body" let-mov>
              <tr>
                <td>{{ mov.fecha | date:'short' }}</td>
                <td>{{ mov.tipo }}</td>
                <td>{{ mov.montoSigned | currency:'COP':'symbol':'1.0-0' }}</td>
                <td>{{ mov.detalle }}</td>
              </tr>
            </ng-template>
          </p-table>

          <div *ngIf="loadingMovs">Cargando movimientos…</div>
          <p *ngIf="!loadingMovs && movimientosEntradas.length === 0">
            No hay entradas para esta cuenta.
          </p>
        </p-tabPanel>

        <!-- SALIDAS -->
        <p-tabPanel header="Salidas">
          <p-table
            [value]="movimientosSalidas"
            *ngIf="!loadingMovs && movimientosSalidas.length > 0"
            class="p-datatable-striped p-shadow-2">
            <ng-template pTemplate="header">
              <tr>
                <th>Fecha</th>
                <th>Tipo</th>
                <th>Monto (COP)</th>
                <th>Detalle</th>
              </tr>
            </ng-template>
            <ng-template pTemplate="body" let-mov>
              <tr>
                <td>{{ mov.fecha | date:'short' }}</td>
                <td>{{ mov.tipo }}</td>
                <td>{{ mov.montoSigned | currency:'COP':'symbol':'1.0-0' }}</td>
                <td>{{ mov.detalle }}</td>
              </tr>
            </ng-template>
          </p-table>

          <div *ngIf="loadingMovs">Cargando movimientos…</div>
          <p *ngIf="!loadingMovs && movimientosSalidas.length === 0">
            No hay salidas para esta cuenta.
          </p>
        </p-tabPanel>
      </p-tabView>
    </p-tabPanel>
  </p-tabView>
</p-card>
